<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Excel Log Viewer</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <!-- SheetJS library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body onload="loadInbox(); loadExcelLog();">

  <h2>ℹ️ Information about this project</h2>
  <p>
    This web application monitors your email inbox for messages containing <strong>@Question</strong> in the subject line.
    It automatically updates the Excel log below, so you can track and review all relevant emails in one place.
  </p>

  <h2>Want to try this out?</h2>
  <p>
    To test the system, send an email with <strong>@Question</strong> in the subject line to <strong>procurementhub361@gmail.com</strong>. Then click <em>Refresh Inbox</em> and <em>Run main.py</em> to see the email appear in the inbox and the Excel log update instantly.
    <br><br>
    If you prefer not to click the buttons, the system will update automatically every 15 minutes.
  </p>

    <h2>Email Inbox: All Emails Received</h2>
    <div id="emailInbox"></div>
    <button id = "refreshInboxButton" onclick="loadInbox()">🔄 Refresh Inbox</button>

    <h2>📊 Excel Log Viewer</h2>
    <div id="output">Loading Excel file...</div>

    <button id="runButton">🔄 Run main.py</button>
    <a href="/download-excel" class="download-btn">⬇️ Download Excel Log</a>
    <div id="status"></div>

   <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
