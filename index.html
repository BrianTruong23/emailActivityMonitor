<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Excel Log Viewer</title>
   <link rel="stylesheet" href="style.css">
  <!-- SheetJS library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <h2>üìä Excel Log Viewer</h2>
    <div id="output">Loading Excel file...</div>

    <button id="runButton">üîÑ Run main.py</button>
    <div id="status"></div>

  <script>
    const excelUrl = 'result/log2.xlsx';

    fetch(excelUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.arrayBuffer();
      })
      .then(arrayBuffer => {
        const workbook = XLSX.read(arrayBuffer, { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];
        let html = XLSX.utils.sheet_to_html(worksheet);

        // Remove default inline styles from SheetJS HTML
        html = html.replace(/<table/g, '<table class="excel-table"');
        document.getElementById('output').innerHTML = html;
      })
      .catch(error => {
        console.error('Error loading Excel file:', error);
        document.getElementById('output').textContent = '‚ö†Ô∏è Failed to load Excel file.';
      });

    document.getElementById("runButton").addEventListener("click", () => {
    document.getElementById("status").textContent = "Running script...";

    fetch("https://your-backend.onrender.com/run-script", {
        method: "POST"
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === "success") {
        document.getElementById("status").textContent = "‚úÖ Script ran successfully.";
        } else {
        document.getElementById("status").textContent = "‚ùå Error: " + data.message;
        }
    })
    .catch(error => {
        document.getElementById("status").textContent = "‚ùå Request failed.";
        console.error(error);
    });
    });
  </script>
</body>
</html>
